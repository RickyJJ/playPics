{
  "code": "import { WebGL } from \"./WebGL\";\r\nimport { ILaya } from \"../../ILaya\";\r\nimport { VertexArrayObject } from \"../../laya/webgl/VertexArrayObject\";\r\nexport class LayaGPU {\r\n    constructor(gl, isWebGL2) {\r\n        this._gl = null;\r\n        this._vaoExt = null;\r\n        this._angleInstancedArrays = null;\r\n        this._isWebGL2 = false;\r\n        this._oesTextureHalfFloat = null;\r\n        this._oesTextureHalfFloatLinear = null;\r\n        this._oesTextureFloat = null;\r\n        this._extTextureFilterAnisotropic = null;\r\n        this._compressedTextureS3tc = null;\r\n        this._compressedTexturePvrtc = null;\r\n        this._compressedTextureEtc1 = null;\r\n        this._gl = gl;\r\n        this._isWebGL2 = isWebGL2;\r\n        try {\r\n            var precisionFormat = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\r\n            precisionFormat.precision ? (WebGL.shaderHighPrecision = true) : WebGL.shaderHighPrecision = false;\r\n        }\r\n        catch (e) {\r\n        }\r\n        if (!isWebGL2) {\r\n            var forceVAO = LayaGPU._forceSupportVAOPlatform();\r\n            if (!ILaya.Render.isConchApp) {\r\n                VertexArrayObject;\r\n                if (window._setupVertexArrayObject) {\r\n                    if (forceVAO)\r\n                        window._forceSetupVertexArrayObject(gl);\r\n                    else\r\n                        window._setupVertexArrayObject(gl);\r\n                }\r\n            }\r\n            this._vaoExt = this._getExtension(\"OES_vertex_array_object\");\r\n            if (!forceVAO)\r\n                this._angleInstancedArrays = this._getExtension(\"ANGLE_instanced_arrays\");\r\n            this._oesTextureHalfFloat = this._getExtension(\"OES_texture_half_float\");\r\n            this._oesTextureHalfFloatLinear = this._getExtension(\"OES_texture_half_float_linear\");\r\n            this._oesTextureFloat = this._getExtension(\"OES_texture_float\");\r\n        }\r\n        else {\r\n            this._getExtension(\"EXT_color_buffer_float\");\r\n        }\r\n        this._extTextureFilterAnisotropic = this._getExtension(\"EXT_texture_filter_anisotropic\");\r\n        this._compressedTextureS3tc = this._getExtension(\"WEBGL_compressed_texture_s3tc\");\r\n        this._compressedTexturePvrtc = this._getExtension(\"WEBGL_compressed_texture_pvrtc\");\r\n        this._compressedTextureEtc1 = this._getExtension(\"WEBGL_compressed_texture_etc1\");\r\n    }\r\n    static _forceSupportVAOPlatform() {\r\n        let Browser = ILaya.Browser;\r\n        return Browser.onBDMiniGame || Browser.onQGMiniGame;\r\n    }\r\n    _getExtension(name) {\r\n        var prefixes = LayaGPU._extentionVendorPrefixes;\r\n        for (var k in prefixes) {\r\n            var ext = this._gl.getExtension(prefixes[k] + name);\r\n            if (ext)\r\n                return ext;\r\n        }\r\n        return null;\r\n    }\r\n    createVertexArray() {\r\n        if (this._isWebGL2)\r\n            return this._gl.createVertexArray();\r\n        else\r\n            return this._vaoExt.createVertexArrayOES();\r\n    }\r\n    bindVertexArray(vertexArray) {\r\n        if (this._isWebGL2)\r\n            this._gl.bindVertexArray(vertexArray);\r\n        else\r\n            this._vaoExt.bindVertexArrayOES(vertexArray);\r\n    }\r\n    deleteVertexArray(vertexArray) {\r\n        if (this._isWebGL2)\r\n            this._gl.deleteVertexArray(vertexArray);\r\n        else\r\n            this._vaoExt.deleteVertexArrayOES(vertexArray);\r\n    }\r\n    isVertexArray(vertexArray) {\r\n        if (this._isWebGL2)\r\n            this._gl.isVertexArray(vertexArray);\r\n        else\r\n            this._vaoExt.isVertexArrayOES(vertexArray);\r\n    }\r\n    drawElementsInstanced(mode, count, type, offset, instanceCount) {\r\n        if (this._isWebGL2)\r\n            this._gl.drawElementsInstanced(mode, count, type, offset, instanceCount);\r\n        else\r\n            this._angleInstancedArrays.drawElementsInstancedANGLE(mode, count, type, offset, instanceCount);\r\n    }\r\n    drawArraysInstanced(mode, first, count, instanceCount) {\r\n        if (this._isWebGL2)\r\n            this._gl.drawArraysInstanced(mode, first, count, instanceCount);\r\n        else\r\n            this._angleInstancedArrays.drawArraysInstancedANGLE(mode, first, count, instanceCount);\r\n    }\r\n    vertexAttribDivisor(index, divisor) {\r\n        if (this._isWebGL2)\r\n            this._gl.vertexAttribDivisor(index, divisor);\r\n        else\r\n            this._angleInstancedArrays.vertexAttribDivisorANGLE(index, divisor);\r\n    }\r\n    supportInstance() {\r\n        if (this._isWebGL2 || this._angleInstancedArrays)\r\n            return true;\r\n        else\r\n            return false;\r\n    }\r\n}\r\nLayaGPU._extentionVendorPrefixes = [\"\", \"WEBKIT_\", \"MOZ_\"];\r\n",
  "references": [
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/laya/webgl/WebGL.ts",
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/ILaya.ts",
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/laya/webgl/VertexArrayObject.ts"
  ]
}
