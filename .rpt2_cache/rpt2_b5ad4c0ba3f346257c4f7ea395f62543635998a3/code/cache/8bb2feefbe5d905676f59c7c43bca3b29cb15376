{
  "code": "import { ILaya } from \"../../ILaya\";\r\nimport { EventDispatcher } from \"../events/EventDispatcher\";\r\nimport { URL } from \"../net/URL\";\r\nexport class Resource extends EventDispatcher {\r\n    constructor() {\r\n        super();\r\n        this._id = 0;\r\n        this._url = null;\r\n        this._cpuMemory = 0;\r\n        this._gpuMemory = 0;\r\n        this._destroyed = false;\r\n        this._referenceCount = 0;\r\n        this.lock = false;\r\n        this.name = null;\r\n        this._id = ++Resource._uniqueIDCounter;\r\n        this._destroyed = false;\r\n        this._referenceCount = 0;\r\n        Resource._idResourcesMap[this.id] = this;\r\n        this.lock = false;\r\n    }\r\n    static get cpuMemory() {\r\n        return Resource._cpuMemory;\r\n    }\r\n    static get gpuMemory() {\r\n        return Resource._gpuMemory;\r\n    }\r\n    static _addCPUMemory(size) {\r\n        Resource._cpuMemory += size;\r\n    }\r\n    static _addGPUMemory(size) {\r\n        Resource._gpuMemory += size;\r\n    }\r\n    static _addMemory(cpuSize, gpuSize) {\r\n        Resource._cpuMemory += cpuSize;\r\n        Resource._gpuMemory += gpuSize;\r\n    }\r\n    static getResourceByID(id) {\r\n        return Resource._idResourcesMap[id];\r\n    }\r\n    static getResourceByURL(url, index = 0) {\r\n        return Resource._urlResourcesMap[url][index];\r\n    }\r\n    static destroyUnusedResources() {\r\n        for (var k in Resource._idResourcesMap) {\r\n            var res = Resource._idResourcesMap[k];\r\n            if (!res.lock && res._referenceCount === 0)\r\n                res.destroy();\r\n        }\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    get url() {\r\n        return this._url;\r\n    }\r\n    get cpuMemory() {\r\n        return this._cpuMemory;\r\n    }\r\n    get gpuMemory() {\r\n        return this._gpuMemory;\r\n    }\r\n    get destroyed() {\r\n        return this._destroyed;\r\n    }\r\n    get referenceCount() {\r\n        return this._referenceCount;\r\n    }\r\n    _setCPUMemory(value) {\r\n        var offsetValue = value - this._cpuMemory;\r\n        this._cpuMemory = value;\r\n        Resource._addCPUMemory(offsetValue);\r\n    }\r\n    _setGPUMemory(value) {\r\n        var offsetValue = value - this._gpuMemory;\r\n        this._gpuMemory = value;\r\n        Resource._addGPUMemory(offsetValue);\r\n    }\r\n    _setCreateURL(url) {\r\n        url = URL.formatURL(url);\r\n        if (this._url !== url) {\r\n            var resList;\r\n            if (this._url) {\r\n                resList = Resource._urlResourcesMap[this._url];\r\n                resList.splice(resList.indexOf(this), 1);\r\n                (resList.length === 0) && (delete Resource._urlResourcesMap[this._url]);\r\n            }\r\n            if (url) {\r\n                resList = Resource._urlResourcesMap[url];\r\n                (resList) || (Resource._urlResourcesMap[url] = resList = []);\r\n                resList.push(this);\r\n            }\r\n            this._url = url;\r\n        }\r\n    }\r\n    _addReference(count = 1) {\r\n        this._referenceCount += count;\r\n    }\r\n    _removeReference(count = 1) {\r\n        this._referenceCount -= count;\r\n    }\r\n    _clearReference() {\r\n        this._referenceCount = 0;\r\n    }\r\n    _recoverResource() {\r\n    }\r\n    _disposeResource() {\r\n    }\r\n    _activeResource() {\r\n    }\r\n    destroy() {\r\n        if (this._destroyed)\r\n            return;\r\n        this._destroyed = true;\r\n        this.lock = false;\r\n        this._disposeResource();\r\n        delete Resource._idResourcesMap[this.id];\r\n        var resList;\r\n        if (this._url) {\r\n            resList = Resource._urlResourcesMap[this._url];\r\n            if (resList) {\r\n                resList.splice(resList.indexOf(this), 1);\r\n                (resList.length === 0) && (delete Resource._urlResourcesMap[this._url]);\r\n            }\r\n            var resou = ILaya.Loader.loadedMap[this._url];\r\n            (resou == this) && (delete ILaya.Loader.loadedMap[this._url]);\r\n        }\r\n    }\r\n}\r\nResource._uniqueIDCounter = 0;\r\nResource._idResourcesMap = {};\r\nResource._urlResourcesMap = {};\r\nResource._cpuMemory = 0;\r\nResource._gpuMemory = 0;\r\n",
  "references": [
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/ILaya.ts",
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/laya/events/EventDispatcher.ts",
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/laya/net/URL.ts",
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/laya/resource/ICreateResource.ts",
    "D:/MySpace/Projects/NextPresent/PresentNext/libs/laya/resource/IDestroy.ts"
  ]
}
